{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"LeafLineage    Thomas Fel,   Thomas Serre    {thomas_fel}@brown.edu  Brown University,  DEEL Team   \ud83d\udc4b Start exploring now \u00bb  <p> The purpose of this tool is to provide a quick overview of the main concepts (dictionary of features) employed by Extant Leaves classification model for each of the 142 Leaf classes, along with an associated importance score for these concepts. For instance, when classifying \"Betulaceae\" the model utilizes features such as Stem, Leaf Blade + Midrib, Leaf Blade. Click on some examples to get started or use the search field at the top to find a specific class. </p> Concept 0 (Importance 11%) Concept 22 (Importance 11%) Concept 6 (Importance 10%) Concept 5 (Importance 8%)  How does it work?  <p>  LENS is straightforward: it's a method that  automatically (they are not predefined) retrieves the concepts (or visual atoms) used by a model for a given class, and assigns an importance score to each of these concepts. The website allows scrolling through the top 10 most important concepts for each class. Each concept is represented by a feature visualization, meaning an image that exemplify the concept (or epitomizes it). By clicking on this feature viz , users can view crops of images that activate this concept. Keep in mind, the higher the importance score, the more determinant the concept is for the model. </p> <p> You can start exploring a class by clicking on one of the feature viz below: </p>  Rhamnaceae  \u00bb   Lauraceae \u00bb   Betulaceae \u00bb    Juglandaceae \u00bb  <p></p> <p>Alternatively, you can begin exploring on your own using the search engine (at the top) or by clicking the    \ud83c\udfb2  Random class \u00bb .</p> <p></p>"},{"location":"#citation","title":"\ud83d\uddde\ufe0f Citation","text":"<p>If you are using LENS as part of your workflow in a scientific publication, please consider citing one of the articles we build on:</p> <p><pre><code>@inproceedings{fel2023craft,\n      title     = {CRAFT: Concept Recursive Activation FacTorization for Explainability},\n      author    = {Thomas Fel and Agustin Picard and Louis Bethune and Thibaut Boissin\n                  and David Vigouroux and Julien Colin and R\u00e9mi Cad\u00e8ne and Thomas Serre},\n      year      = {2023},\n      booktitle = {Proceedings of the IEEE Conference on Computer Vision and \n                   Pattern Recognition (CVPR)},\n}\n</code></pre> <pre><code>@article{fel2023holistic,\n  title         = {A Holistic Approach to Unifying Automatic Concept Extraction \n                  and Concept Importance Estimation},\n  author        = {Thomas Fel and Victor Boutin and Mazda Moayeri and R\u00e9mi Cad\u00e8ne and Louis Bethune\n                  and L\u00e9o and\u00e9ol and Mathieu Chalvidal and Thomas Serre},\n  journal       = {Advances in Neural Information Processing Systems (NeurIPS)},\n  year          = {2023}\n}\n</code></pre> <pre><code>@article{fel2023unlocking,\n  title         = {Unlocking Feature Visualization for Deeper Networks with \n                  MAgnitude Constrained Optimization},\n  author        = {Thomas Fel and Thibaut Boissin and Victor Boutin and Agustin Picard and\n                  Paul Novello and Julien Colin and Drew Linsley and Tom Rousseau and\n                  R\u00e9mi Cad\u00e8ne and Laurent Gardes, Thomas Serre},\n  journal       = {Advances in Neural Information Processing Systems (NeurIPS)},\n  year          = {2023}\n}\n</code></pre></p>"},{"location":"#license","title":"\ud83d\udcdd License","text":"<p>The project is released under  MIT license.</p> <ol> <li> <p>Learning a Dictionary of Shape-Components in Visual Cortex: Comparison with Neurons, Humans and Machines \u21a9</p> </li> <li> <p>Interpretability Beyond Feature Attribution: Quantitative Testing with Concept Activation Vectors (TCAV) (2018). \u21a9</p> </li> <li> <p>Towards Automatic Concept-based Explanations (ACE) (2019). \u21a9</p> </li> <li> <p>Invertible Concept-based Explanations for CNN Models with Non-negative Concept Activation Vectors (2021). \u21a9</p> </li> <li> <p>Thread: Circuits: What can we learn if we invest heavily in reverse engineering a single neural network? (2020). \u21a9</p> </li> <li> <p>Feature Visualization: How neural networks build up their understanding of images (2017). \u21a9</p> </li> <li> <p>Toy Models of Superposition (2022). \u21a9</p> </li> <li> <p>Progress measures for Grokking via Mechanistic Interpretability (2023). \u21a9</p> </li> <li> <p>Which explanation should i choose? a function approximation perspective to characterizing post hoc explanations. (2022). \u21a9</p> </li> <li> <p>Towards the Unification and Robustness of Perturbation and Gradient Based Explanations. (2021). \u21a9</p> </li> <li> <p>Towards Faithfully Interpretable NLP Systems: How Should We Define and Evaluate Faithfulness? (2020). \u21a9</p> </li> <li> <p>Interpretable Explanations of Black Boxes by Meaningful Perturbation. (2017). \u21a9</p> </li> <li> <p>On the (In)fidelity and Sensitivity of Explanations. (2019). \u21a9</p> </li> <li> <p>Evaluating and Aggregating Feature-based Model Explanation. (2020). \u21a9</p> </li> </ol>"},{"location":"method/","title":"LENS Method","text":"<p>The pages contain a lot of information, and the goal is to guide you gradually towards a better understanding of interpreting these results.  </p>"},{"location":"method/#summary","title":"Summary","text":"<p>In summary, the method is quite simple: for each class, we take the points in the ImageNet dataset  predicted as and extract the concepts (directions on intermediate space) from these points using the CRAFT  method.  Once these concepts are obtained, they are just vectors in the latent space, and it is possible to obtain a  feature visualization - an image that maximise this direction - of these  vectors using MACO .  Finally, since the decomposition is performed on the last layer, there is a linear relationship between the concept embedding and the model's decision. More details on the estimation of importance can be found in the Holistic article. Now let's move on to interpreting the different components.  </p>"},{"location":"method/#understanding-concept-importance","title":"Understanding concept importance","text":"<p>For each point in the dataset, it is possible to obtain it's concepts values where  each values represent a concept. Moreover, we can also compute an importance vector, this vector  has a scalar value per concept, representing how crucial a concept was for the classification.  Based on these vectors, we perform UMAP to obtain the clustering graph.  Then, colors are assigned to each point based on its most important concept.  If a concept is the most important for at least 10 times, it is considered important and will be colored.  Finally, the global importance is the average of the logit scores contributed by the concepts across all points. Thus, a global importance of 30% means that the concept represents 30% of the sum of logits for the class.  </p>"},{"location":"method/#understanding-concept-proximity","title":"Understanding Concept proximity","text":"<p>For each concept, it is possible to obtain its proximity to other concepts, i.e., how close they are in the latent space. To do this, we calculate the pairwise cosine similarity between the concepts. We then project  the results into 2D. Thus, two close concepts will have a close cosine similarity.  </p>"},{"location":"method/#understanding-concept-alignment-to-classes","title":"Understanding Concept Alignment to Classes","text":"<p>Similar to concept proximity, it is possible to compare the class's separating hyperplane with the concept, which gives us a degree of alignment between the concept and each class. The reported score is also the cosine similarity between the two vectors.</p>"},{"location":"classes/Anacardiaceae/","title":"Anacardiaceae","text":""},{"location":"classes/Anacardiaceae/#anacardiaceae-has-2-important-leaves-concepts","title":"Anacardiaceae has 2 important leaves concepts.","text":""},{"location":"classes/Anacardiaceae/#anacardiaceae-has-3-important-fossils-concepts","title":"Anacardiaceae has 3 important fossils concepts.","text":""},{"location":"classes/Anacardiaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 11 (Importance 15%) Concept 14 (Importance 10%) Concept 8 (Importance 8%) Concept 25 (Importance 6%) Concept 0 (Importance 5%) Concept 13 (Importance 5%) Concept 21 (Importance 4%) Concept 38 (Importance 4%) Concept 24 (Importance 4%) Concept 3 (Importance 4%) Concept 0 (Importance 11%) Concept 22 (Importance 11%) Concept 6 (Importance 10%) Concept 5 (Importance 8%) Concept 36 (Importance 6%) Concept 20 (Importance 4%) Concept 8 (Importance 4%) Concept 13 (Importance 4%) Concept 35 (Importance 3%) Concept 17 (Importance 3%)"},{"location":"classes/Berberidaceae/","title":"Berberidaceae","text":""},{"location":"classes/Berberidaceae/#berberidaceae-has-2-important-leaves-concepts","title":"Berberidaceae has 2 important leaves concepts.","text":""},{"location":"classes/Berberidaceae/#berberidaceae-has-4-important-fossils-concepts","title":"Berberidaceae has 4 important fossils concepts.","text":""},{"location":"classes/Berberidaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 3 (Importance 16%) Concept 0 (Importance 9%) Concept 22 (Importance 8%) Concept 11 (Importance 7%) Concept 23 (Importance 7%) Concept 38 (Importance 5%) Concept 33 (Importance 5%) Concept 17 (Importance 5%) Concept 9 (Importance 4%) Concept 36 (Importance 4%) Concept 35 (Importance 19%) Concept 7 (Importance 12%) Concept 15 (Importance 10%) Concept 31 (Importance 10%) Concept 29 (Importance 8%) Concept 9 (Importance 4%) Concept 4 (Importance 4%) Concept 3 (Importance 4%) Concept 2 (Importance 3%) Concept 23 (Importance 3%)"},{"location":"classes/Betulaceae/","title":"Betulaceae","text":""},{"location":"classes/Betulaceae/#betulaceae-has-5-important-leaves-concepts","title":"Betulaceae has 5 important leaves concepts.","text":""},{"location":"classes/Betulaceae/#betulaceae-has-5-important-fossils-concepts","title":"Betulaceae has 5 important fossils concepts.","text":""},{"location":"classes/Betulaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 21 (Importance 23%) Concept 10 (Importance 21%) Concept 25 (Importance 15%) Concept 23 (Importance 11%) Concept 22 (Importance 9%) Concept 38 (Importance 8%) Concept 18 (Importance 8%) Concept 6 (Importance 8%) Concept 37 (Importance 7%) Concept 14 (Importance 7%) Concept 12 (Importance 19%) Concept 38 (Importance 15%) Concept 32 (Importance 14%) Concept 15 (Importance 12%) Concept 25 (Importance 9%) Concept 35 (Importance 8%) Concept 2 (Importance 8%) Concept 39 (Importance 7%) Concept 11 (Importance 7%) Concept 0 (Importance 7%)"},{"location":"classes/Cupressaceae/","title":"Cupressaceae","text":""},{"location":"classes/Cupressaceae/#cupressaceae-has-9-important-leaves-concepts","title":"Cupressaceae has 9 important leaves concepts.","text":""},{"location":"classes/Cupressaceae/#cupressaceae-has-2-important-fossils-concepts","title":"Cupressaceae has 2 important fossils concepts.","text":""},{"location":"classes/Cupressaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 0 (Importance 30%) Concept 1 (Importance 16%) Concept 6 (Importance 16%) Concept 31 (Importance 13%) Concept 4 (Importance 13%) Concept 24 (Importance 13%) Concept 27 (Importance 11%) Concept 11 (Importance 11%) Concept 2 (Importance 9%) Concept 34 (Importance 8%) Concept 0 (Importance 20%) Concept 7 (Importance 10%) Concept 32 (Importance 7%) Concept 6 (Importance 7%) Concept 9 (Importance 7%) Concept 5 (Importance 5%) Concept 39 (Importance 5%) Concept 4 (Importance 4%) Concept 20 (Importance 4%) Concept 22 (Importance 4%)"},{"location":"classes/Dryopteridaceae/","title":"Dryopteridaceae","text":""},{"location":"classes/Dryopteridaceae/#dryopteridaceae-has-6-important-leaves-concepts","title":"Dryopteridaceae has 6 important leaves concepts.","text":""},{"location":"classes/Dryopteridaceae/#dryopteridaceae-has-3-important-fossils-concepts","title":"Dryopteridaceae has 3 important fossils concepts.","text":""},{"location":"classes/Dryopteridaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 0 (Importance 29%) Concept 2 (Importance 16%) Concept 26 (Importance 13%) Concept 19 (Importance 11%) Concept 25 (Importance 10%) Concept 14 (Importance 9%) Concept 5 (Importance 5%) Concept 13 (Importance 4%) Concept 10 (Importance 4%) Concept 8 (Importance 4%) Concept 9 (Importance 16%) Concept 0 (Importance 13%) Concept 5 (Importance 12%) Concept 4 (Importance 8%) Concept 13 (Importance 6%) Concept 36 (Importance 6%) Concept 15 (Importance 5%) Concept 38 (Importance 5%) Concept 18 (Importance 4%) Concept 11 (Importance 4%)"},{"location":"classes/Juglandaceae/","title":"Juglandaceae","text":""},{"location":"classes/Juglandaceae/#juglandaceae-has-5-important-leaves-concepts","title":"Juglandaceae has 5 important leaves concepts.","text":""},{"location":"classes/Juglandaceae/#juglandaceae-has-5-important-fossils-concepts","title":"Juglandaceae has 5 important fossils concepts.","text":""},{"location":"classes/Juglandaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 30 (Importance 14%) Concept 20 (Importance 13%) Concept 26 (Importance 9%) Concept 35 (Importance 9%) Concept 39 (Importance 9%) Concept 24 (Importance 8%) Concept 8 (Importance 6%) Concept 25 (Importance 6%) Concept 6 (Importance 5%) Concept 37 (Importance 5%) Concept 0 (Importance 14%) Concept 15 (Importance 11%) Concept 12 (Importance 10%) Concept 37 (Importance 10%) Concept 17 (Importance 10%) Concept 2 (Importance 8%) Concept 34 (Importance 5%) Concept 4 (Importance 5%) Concept 11 (Importance 5%) Concept 18 (Importance 4%)"},{"location":"classes/Lauraceae/","title":"Lauraceae","text":""},{"location":"classes/Lauraceae/#lauraceae-has-6-important-leaves-concepts","title":"Lauraceae has 6 important leaves concepts.","text":""},{"location":"classes/Lauraceae/#lauraceae-has-2-important-fossils-concepts","title":"Lauraceae has 2 important fossils concepts.","text":""},{"location":"classes/Lauraceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 19 (Importance 16%) Concept 22 (Importance 12%) Concept 1 (Importance 10%) Concept 13 (Importance 9%) Concept 17 (Importance 9%) Concept 24 (Importance 9%) Concept 20 (Importance 6%) Concept 38 (Importance 6%) Concept 30 (Importance 5%) Concept 18 (Importance 5%) Concept 9 (Importance 10%) Concept 24 (Importance 9%) Concept 3 (Importance 5%) Concept 16 (Importance 5%) Concept 7 (Importance 4%) Concept 2 (Importance 4%) Concept 10 (Importance 4%) Concept 17 (Importance 4%) Concept 31 (Importance 4%) Concept 19 (Importance 4%)"},{"location":"classes/Meliaceae/","title":"Meliaceae","text":""},{"location":"classes/Meliaceae/#meliaceae-has-3-important-leaves-concepts","title":"Meliaceae has 3 important leaves concepts.","text":""},{"location":"classes/Meliaceae/#meliaceae-has-3-important-fossils-concepts","title":"Meliaceae has 3 important fossils concepts.","text":""},{"location":"classes/Meliaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 21 (Importance 14%) Concept 12 (Importance 12%) Concept 18 (Importance 9%) Concept 26 (Importance 8%) Concept 6 (Importance 6%) Concept 13 (Importance 6%) Concept 27 (Importance 5%) Concept 17 (Importance 5%) Concept 29 (Importance 4%) Concept 38 (Importance 4%) Concept 25 (Importance 12%) Concept 23 (Importance 9%) Concept 30 (Importance 9%) Concept 6 (Importance 7%) Concept 33 (Importance 6%) Concept 0 (Importance 6%) Concept 5 (Importance 6%) Concept 4 (Importance 5%) Concept 11 (Importance 4%) Concept 35 (Importance 4%)"},{"location":"classes/Myrtaceae/","title":"Myrtaceae","text":""},{"location":"classes/Myrtaceae/#myrtaceae-has-1-important-leaves-concepts","title":"Myrtaceae has 1 important leaves concepts.","text":""},{"location":"classes/Myrtaceae/#myrtaceae-has-5-important-fossils-concepts","title":"Myrtaceae has 5 important fossils concepts.","text":""},{"location":"classes/Myrtaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 32 (Importance 12%) Concept 18 (Importance 7%) Concept 10 (Importance 6%) Concept 14 (Importance 6%) Concept 6 (Importance 6%) Concept 35 (Importance 5%) Concept 34 (Importance 5%) Concept 37 (Importance 5%) Concept 5 (Importance 5%) Concept 27 (Importance 5%) Concept 8 (Importance 18%) Concept 23 (Importance 13%) Concept 17 (Importance 10%) Concept 15 (Importance 10%) Concept 16 (Importance 9%) Concept 10 (Importance 6%) Concept 13 (Importance 6%) Concept 37 (Importance 6%) Concept 28 (Importance 5%) Concept 32 (Importance 4%)"},{"location":"classes/Pinaceae/","title":"Pinaceae","text":""},{"location":"classes/Pinaceae/#pinaceae-has-1-important-leaves-concepts","title":"Pinaceae has 1 important leaves concepts.","text":""},{"location":"classes/Pinaceae/#pinaceae-has-2-important-fossils-concepts","title":"Pinaceae has 2 important fossils concepts.","text":""},{"location":"classes/Pinaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 35 (Importance 9%) Concept 3 (Importance 4%) Concept 16 (Importance 4%) Concept 8 (Importance 4%) Concept 17 (Importance 4%) Concept 29 (Importance 4%) Concept 23 (Importance 4%) Concept 34 (Importance 4%) Concept 31 (Importance 3%) Concept 21 (Importance 3%) Concept 25 (Importance 17%) Concept 9 (Importance 16%) Concept 5 (Importance 8%) Concept 13 (Importance 8%) Concept 18 (Importance 7%) Concept 36 (Importance 6%) Concept 4 (Importance 6%) Concept 14 (Importance 5%) Concept 31 (Importance 5%) Concept 37 (Importance 4%)"},{"location":"classes/Rhamnaceae/","title":"Rhamnaceae","text":""},{"location":"classes/Rhamnaceae/#rhamnaceae-has-9-important-leaves-concepts","title":"Rhamnaceae has 9 important leaves concepts.","text":""},{"location":"classes/Rhamnaceae/#rhamnaceae-has-5-important-fossils-concepts","title":"Rhamnaceae has 5 important fossils concepts.","text":""},{"location":"classes/Rhamnaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 35 (Importance 19%) Concept 24 (Importance 17%) Concept 3 (Importance 14%) Concept 12 (Importance 13%) Concept 32 (Importance 11%) Concept 31 (Importance 10%) Concept 6 (Importance 10%) Concept 22 (Importance 10%) Concept 23 (Importance 9%) Concept 8 (Importance 8%) Concept 31 (Importance 38%) Concept 39 (Importance 23%) Concept 38 (Importance 15%) Concept 10 (Importance 12%) Concept 25 (Importance 10%) Concept 19 (Importance 8%) Concept 2 (Importance 7%) Concept 8 (Importance 7%) Concept 37 (Importance 6%) Concept 18 (Importance 5%)"},{"location":"classes/Salicaceae/","title":"Salicaceae","text":""},{"location":"classes/Salicaceae/#salicaceae-has-7-important-leaves-concepts","title":"Salicaceae has 7 important leaves concepts.","text":""},{"location":"classes/Salicaceae/#salicaceae-has-6-important-fossils-concepts","title":"Salicaceae has 6 important fossils concepts.","text":""},{"location":"classes/Salicaceae/#concepts-visualization","title":"Concepts visualization","text":"<p>Below, you'll find a visualization of the class concepts. Simply Click on a concept to see natural images that strongly activate that specific concept. The important concepts are highlighted in color and are the ones that are the most important for at least 10 points (images).</p> Leaves Concepts Fossils Concepts Concept 6 (Importance 22%) Concept 35 (Importance 13%) Concept 27 (Importance 12%) Concept 8 (Importance 11%) Concept 16 (Importance 10%) Concept 17 (Importance 10%) Concept 37 (Importance 9%) Concept 14 (Importance 8%) Concept 12 (Importance 5%) Concept 25 (Importance 5%) Concept 5 (Importance 17%) Concept 0 (Importance 17%) Concept 39 (Importance 11%) Concept 6 (Importance 10%) Concept 2 (Importance 9%) Concept 22 (Importance 9%) Concept 11 (Importance 5%) Concept 10 (Importance 5%) Concept 16 (Importance 5%) Concept 27 (Importance 3%)"}]}